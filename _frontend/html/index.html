<!DOCTYPE html>
<html lang="fr">

<head>
    <title>Hurlu's Recipes Manager</title>
    <link href="/static/css/styles.css" type="text/css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <meta charset="UTF-8" />
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0' />
</head>

<body class="page">
<header>
    <div class='logo'>
        <a href="/"><img alt="Miam!" src='/static/img/RasterLogo.png'/></a>
    </div>
    <ul class='menu'>
        <li>Rechercher</li>
        <li><a href='/connect'>Se connecter</a></li>
        <li><a href='/user/[[username]]'><img class="userlogo" src="/static/img/User.png"/></a></li>
    </ul>
    <div class="nav__icon">
        <span></span>
        <span></span>
        <span></span>
    </div>
</header>
<div class="flex">
    <div class="flex box-container">
        {{ range $ri, $recipe := .recipes }}
            <div class="box">
                <div class="feature-img">
                    <img class="box-image" src="{{$recipe.DisplayPic}}" uri="{{$recipe.GetUrl}}">
                </div>
                <div class="box-content">
                    <h4 class="box-title">{{.Name}}</h4>
                    <ul class="tags">
                    {{ range $ti, $tag := .Tags}}
                        <li><a href="/tags/{{$tag}}" class="tag">{{$tag}}</a></li>
                    {{ end }}
                    </ul>
                </div>
            </div>
        {{ end }}
    </div>
</div>
<form>
    <div class="search-div">
        <form method="post" action="/tags/query">
            <label></label>
        <input type="text" name="search" class="search-txt" placeholder="Chercher une recette"/>
        <a class="search-btn">
            <i class="fas fa-search"></i>
        </a>
        <a class="search-btn">
            <i class="fas fa-question-circle"></i>
        </a>
        </form>
    </div>
</form>

</body>


{{/*SlideToggle vanilla JS implem*/}}
<script>
    let slideUp = (target, duration=500) => {
        target.style.transitionProperty = 'height, margin, padding';
        target.style.transitionDuration = duration + 'ms';
        target.style.boxSizing = 'border-box';
        target.style.height = target.offsetHeight + 'px';
        target.offsetHeight;
        target.style.overflow = 'hidden';
        target.style.height = 0;
        target.style.paddingTop = 0;
        target.style.paddingBottom = 0;
        target.style.marginTop = 0;
        target.style.marginBottom = 0;
        window.setTimeout( () => {
            target.style.display = 'none';
            target.style.removeProperty('height');
            target.style.removeProperty('padding-top');
            target.style.removeProperty('padding-bottom');
            target.style.removeProperty('margin-top');
            target.style.removeProperty('margin-bottom');
            target.style.removeProperty('overflow');
            target.style.removeProperty('transition-duration');
            target.style.removeProperty('transition-property');
            //alert("!");
        }, duration);
    }

    let slideDown = (target, duration=500) => {
        target.style.removeProperty('display');
        let display = window.getComputedStyle(target).display;

        if (display === 'none')
            display = 'block';

        target.style.display = display;
        let height = target.offsetHeight;
        target.style.overflow = 'hidden';
        target.style.height = 0;
        target.style.paddingTop = 0;
        target.style.paddingBottom = 0;
        target.style.marginTop = 0;
        target.style.marginBottom = 0;
        target.offsetHeight;
        target.style.boxSizing = 'border-box';
        target.style.transitionProperty = "height, margin, padding";
        target.style.transitionDuration = duration + 'ms';
        target.style.height = height + 'px';
        target.style.removeProperty('padding-top');
        target.style.removeProperty('padding-bottom');
        target.style.removeProperty('margin-top');
        target.style.removeProperty('margin-bottom');
        window.setTimeout( () => {
            target.style.removeProperty('height');
            target.style.removeProperty('overflow');
            target.style.removeProperty('transition-duration');
            target.style.removeProperty('transition-property');
        }, duration);
    }
    var slideToggle = (target, duration = 500) => {
        if (window.getComputedStyle(target).display === 'none') {
            return slideDown(target, duration);
        } else {
            return slideUp(target, duration);
        }
    }
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        for (let elem of document.getElementsByClassName("box-image")) {
            elem.onclick = function () {
                uri = elem.getAttribute("uri");
                document.location.href = uri;
            }
        }
    })
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        let elem = document.getElementsByClassName("nav__icon")[0];
        let menu = document.getElementsByClassName("menu")[0];
        if (document.body.clientWidth < 960)
            slideUp(menu, 0);
        elem.onclick = function () {
            if (elem.className == "nav__icon") {
                elem.className += " active";
            }
            else {
                elem.className = elem.className.replace(" active", "");
            }
            slideToggle(menu, 500);
        }
    });

    window.onresize = function () {
        let elem = document.getElementsByClassName("nav__icon")[0];
        let menu = document.getElementsByClassName("menu")[0];
        let width = document.body.clientWidth;
        elem.className = elem.className.replace(" active", "");
        if (width > 960){
            slideDown(menu, 0);
        }
        else {
            slideUp(menu, 0);
        }
    };

</script>

</html>
